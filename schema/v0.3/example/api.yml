kapi: v0.3
type: api

info:
  title: Example API
  version: 1.0.0

imports:
  err: includes/errors.yml

routes:
  /api:
    get:
      summary: API Documentation
      description: Returns the rendered HTML documentation for this API.
      responses:
        200:
          summary: Success
          content:
            text/html:
              value: any
        500:
          summary: Server Error
          content:
            application/json:
              value: err.ServerError
  /health:
    get:
      summary: Service Health Info
      responses:
        200:
          summary: Success
          content:
            application/json:
              value: ServiceHealthInfo




components:
  types:
  - name: ServiceHealthInfo
    base: object
    properties:
      serviceName: string
      serviceVersion: string
      serviceHealth: ServiceHealthStatus
      dependencies:
        type: list
        values: DependencyHealthInfo

  - name: DependencyHealthInfo
    base: object
    properties:
      dependencyName: string
      dependencyStatus: DependencyStatus

  - name: ServiceHealthStatus
    base: enum
    wraps: string
    values:
      Healthy: healthy
      Unhealthy: unhealthy

  - name: DependencyStatus
    base: enum
    wraps: string
    values:
      Healthy: healthy
      Unknown: unknown
      Unreachable: unreachable
